"use strict";function n(n){return n}function e(n){return function(){return n}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(void 0);function r(n,e,t,r,o,u,i,a,c,s,f,l,h,d,g,v,m,p,y,_){switch(arguments.length){case 1:return n;case 2:return e(n);case 3:return t(e(n));case 4:return r(t(e(n)));case 5:return o(r(t(e(n))));case 6:return u(o(r(t(e(n)))));case 7:return i(u(o(r(t(e(n))))));case 8:return a(i(u(o(r(t(e(n)))))));case 9:return c(a(i(u(o(r(t(e(n))))))));case 10:return s(c(a(i(u(o(r(t(e(n)))))))));case 11:return f(s(c(a(i(u(o(r(t(e(n))))))))));case 12:return l(f(s(c(a(i(u(o(r(t(e(n)))))))))));case 13:return h(l(f(s(c(a(i(u(o(r(t(e(n))))))))))));case 14:return d(h(l(f(s(c(a(i(u(o(r(t(e(n)))))))))))));case 15:return g(d(h(l(f(s(c(a(i(u(o(r(t(e(n))))))))))))));case 16:return v(g(d(h(l(f(s(c(a(i(u(o(r(t(e(n)))))))))))))));case 17:return m(v(g(d(h(l(f(s(c(a(i(u(o(r(t(e(n))))))))))))))));case 18:return p(m(v(g(d(h(l(f(s(c(a(i(u(o(r(t(e(n)))))))))))))))));case 19:return y(p(m(v(g(d(h(l(f(s(c(a(i(u(o(r(t(e(n))))))))))))))))));case 20:return _(y(p(m(v(g(d(h(l(f(s(c(a(i(u(o(r(t(e(n)))))))))))))))))))}}var o=function(n){return"Left"===n._tag},u=function(n){return{_tag:"Left",left:n}},i=function(n){return{_tag:"Right",right:n}},a=function(n){return[n]},c=u,s=i,f=function(n){return function(e){return h(e)?e:s(n(e.right))}},l=function(n){return function(e){return h(e)?e:n(e.right)}},h=o,d=function(n){return"Right"===n._tag},g=function(n,e){return function(t){return h(t)?n(t.left):e(t.right)}},v={_tag:"None"},m=function(n){return{_tag:"Some",value:n}},p=function(n){return function(e){return _(e)?v:n(e.value)}},y=function(n){return"Left"===n._tag?v:m(n.right)},_=function(n){return"None"===n._tag},b=function(n,e){return function(t){return _(t)?n():e(t.value)}},w=function(n){return function(e){return _(e)?n():e.value}},x=function(n){return null==n?v:m(n)};function S(n){return function(n,e,t,r,o,u,i,a,c){switch(arguments.length){case 1:return n;case 2:return function(){return e(n.apply(this,arguments))};case 3:return function(){return t(e(n.apply(this,arguments)))};case 4:return function(){return r(t(e(n.apply(this,arguments))))};case 5:return function(){return o(r(t(e(n.apply(this,arguments)))))};case 6:return function(){return u(o(r(t(e(n.apply(this,arguments))))))};case 7:return function(){return i(u(o(r(t(e(n.apply(this,arguments)))))))};case 8:return function(){return a(i(u(o(r(t(e(n.apply(this,arguments))))))))};case 9:return function(){return c(a(i(u(o(r(t(e(n.apply(this,arguments)))))))))}}}(s,n.of)}var E=function(n,e){return function(){return n().then(i,(function(n){return u(e(n))}))}},O=S({URI:"Task",of:function(n){return function(){return Promise.resolve(n)}}})([]),N=function(n){var e=function(n){return function(e){return function(){return function(n){return n.slice(1)}(e).reduce((function(e,t,r){return e.then((function(u){return o(u)?e:n(r+1,t)().then((function(n){return o(n)?n:(u.right.push(n.right),u)}))}))}),n(0,function(n){return n[0]}(e))().then(f(a)))}}}(n);return function(n){return function(n){return n.length>0}(n)?e(n):O}},P=function(n){return N((function(e,t){return n(t)}))}(n),j=r,z=function(n,e){return{_tag:"Concat",left:n,right:e}};function k(){return{concat:z}}var R={is:function(n){return"boolean"==typeof n}};var A=k(),D={URI:"Either",_E:void 0,map:function(n,e){return j(n,f(e))},ap:function(n,e){return h(n)?h(e)?c(A.concat(n.left,e.left)):n:h(e)?e:s(n.right(e.right))},of:s,chain:function(n,e){return j(n,l(e))},throwError:c,bimap:function(n,e,t){return j(n,function(n,e){return function(t){return h(t)?c(n(t.left)):s(e(t.right))}}(e,t))},mapLeft:function(n,e){return j(n,function(n){return function(e){return h(e)?c(n(e.left)):e}}(e))},alt:function(n,e){if(d(n))return n;var t=e();return h(t)?c(A.concat(n.left,t.left)):t}},L=function(n,e){return function(n,e){return function(n){return function(e,t){return{decode:function(r){return e(r)?n.of(r):n.throwError(t(r))}}}}(D)(n,(function(n){return{_tag:"Of",value:function(n,e){return{_tag:"Leaf",actual:n,error:e}}(n,e)}}))}(n.is,e)}(R,"boolean"),M={},F={};Object.defineProperty(F,"__esModule",{value:!0}),F.AnonymousSelect=F.NamedSelect=F.Not=F.Guard=F.PatternKind=void 0,F.PatternKind=Symbol("@ts-pattern/pattern-kind"),F.Guard=Symbol("@ts-pattern/guard"),F.Not=Symbol("@ts-pattern/not"),F.NamedSelect=Symbol("@ts-pattern/named-select"),F.AnonymousSelect=Symbol("@ts-pattern/anonymous-select");var K={};!function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.instanceOf=n.select=n.ANONYMOUS_SELECT_KEY=n.not=n.when=void 0;const e=F;n.when=n=>({[e.PatternKind]:e.Guard,[e.Guard]:n});n.not=n=>({[e.PatternKind]:e.Not,[e.Not]:n}),n.ANONYMOUS_SELECT_KEY="@ts-pattern/__anonymous-select-key",n.select=function(n){return void 0===n?{[e.PatternKind]:e.AnonymousSelect}:{[e.PatternKind]:e.NamedSelect,[e.NamedSelect]:n}};n.instanceOf=e=>n.when(function(n){return e=>e instanceof n}(e))}(K);var C={};Object.defineProperty(C,"__esModule",{value:!0}),C.__=void 0;const T=K;const Y=T.when((function(n){return!0})),U=T.when((function(n){return"string"==typeof n})),G=T.when((function(n){return"number"==typeof n&&!Number.isNaN(n)})),I=T.when((function(n){return"boolean"==typeof n})),q=T.when((function(n){return null==n}));C.__=Object.assign(Y,{string:U,number:G,boolean:I,nullish:q}),function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isMatching=n.match=n.instanceOf=n.select=n.not=n.when=n.__=void 0;const e=F,t=K;Object.defineProperty(n,"when",{enumerable:!0,get:function(){return t.when}}),Object.defineProperty(n,"not",{enumerable:!0,get:function(){return t.not}}),Object.defineProperty(n,"select",{enumerable:!0,get:function(){return t.select}}),Object.defineProperty(n,"instanceOf",{enumerable:!0,get:function(){return t.instanceOf}});const r=C;Object.defineProperty(n,"__",{enumerable:!0,get:function(){return r.__}});n.match=n=>o(n,[]);const o=(n,e)=>{const r=()=>{const t=e.find((({test:e})=>e(n)));if(!t){let e;try{e=JSON.stringify(n)}catch(t){e=n}throw new Error(`Pattern matching error: no pattern matches value ${e}`)}return t.handler(t.select(n),n)};return{with(...r){const u=r[r.length-1],a=[],c=[];for(let n=0;n<r.length-1;n++){const e=r[n];"function"==typeof e?c.push(e):a.push(e)}let s={};return o(n,e.concat([{test:n=>Boolean(a.some((e=>i(e,n,((n,e)=>{s[n]=e}))))&&c.every((e=>e(n)))),handler:u,select:n=>Object.keys(s).length?void 0!==s[t.ANONYMOUS_SELECT_KEY]?s[t.ANONYMOUS_SELECT_KEY]:s:n}]))},when:(t,r)=>o(n,e.concat([{test:t,handler:r,select:n=>n}])),otherwise:t=>o(n,e.concat([{test:()=>!0,handler:t,select:n=>n}])).run(),exhaustive:()=>r(),run:r}},u=n=>Boolean(n&&"object"==typeof n),i=(n,o,a)=>{if(u(n)){if((c=n)&&c[e.PatternKind]===e.Guard)return Boolean(n[e.Guard](o));if((n=>n&&n[e.PatternKind]===e.NamedSelect)(n))return a(n[e.NamedSelect],o),!0;if((n=>n&&n[e.PatternKind]===e.AnonymousSelect)(n))return a(t.ANONYMOUS_SELECT_KEY,o),!0;if((n=>n&&n[e.PatternKind]===e.Not)(n))return!i(n[e.Not],o,a);if(!u(o))return!1;if(Array.isArray(n)){if(!Array.isArray(o))return!1;if(1===n.length){const e={},t=(n,t)=>{e[n]=(e[n]||[]).concat([t])},r=o.every((e=>i(n[0],e,t)));return r&&Object.keys(e).forEach((n=>a(n,e[n]))),r}return n.length===o.length&&n.every(((n,e)=>i(n,o[e],a)))}if(n instanceof Map)return o instanceof Map&&[...n.keys()].every((e=>i(n.get(e),o.get(e),a)));if(n instanceof Set){if(!(o instanceof Set))return!1;if(0===n.size)return 0===o.size;if(1===n.size){const[e]=[...n.values()];return Object.values(r.__).includes(e)?i([e],[...o.values()],a):o.has(e)}return[...n.values()].every((n=>o.has(n)))}return Object.keys(n).every((e=>e in o&&i(n[e],o[e],a)))}var c;return o===n};n.isMatching=function(...n){if(1===n.length){const[e]=n;return n=>i(e,n,(()=>{}))}if(2===n.length){const[e,t]=n;return i(e,t,(()=>{}))}throw new Error(`isMatching wasn't given enough arguments: expected 1 or 2, received ${n.length}.`)}}(M);var B,$=function(n){return function(e){r(n,b((function(){return console.log(nova.localize("Skipping. No Langunage Client running.")+".")}),(function(n){(function(n,e){return E((function(){return e.selectedRange,e.selectedText,n.sendRequest("textDocument/references",{textDocument:{uri:e.document.uri},position:(t=e.document,r(t.getTextInRange(new Range(0,t.length)),(function(n){return n.split(t.eol)}),(o=function(n,e){e.length,t.eol.length},function(n){return n.map((function(n,e){return o(e,n)}))})),{line:"0",character:"0"}),context:{includeDeclaration:!1}}).then((function(){}));var t,o}),(function(){return{_tag:"invokeReferencesError",reason:nova.localize("Failed to find references")+"."}}))})(n,e)().then(g((function(n){return M.match(n).with({_tag:"invokeReferencesError"},(function(n){var e=n.reason;return console.error(e)})).exhaustive()}),(function(){return console.log(nova.localize("View sidebar for results")+".")})))})))}},J=function(n,e){return E((function(){return n.sendRequest("textDocument/formatting",{textDocument:{uri:e.document.uri},options:{}}).then((function(n){e.edit((function(t){n.map((function(n){var r=function(n,e){for(var t=0,r=0,o=0,u=n.getTextInRange(new Range(0,n.length)).split(n.eol),i=0;i<u.length;i++){var a=u[i].length+n.eol.length;if(e.start.line===i&&(t=o+e.start.character),e.end.line===i){r=o+e.end.character;break}o+=a}return new Range(t,r)}(e.document,n.range);t.replace(r,n.newText)}))}))}))}),(function(){return{_tag:"invokeFormatterError",reason:nova.localize("Failed to format the document")+"."}}))};!function(n){n.FindReferences="hansjhoffman.elixir.commands.findReferences",n.FormatOnSave="hansjhoffman.elixir.config.formatOnSave",n.FormatDocument="hansjhoffman.elixir.commands.formatDocument",n.Sidebar="hansjhoffman.elixir.sidebar",n.SidebarResults="hansjhoffman.elixir.sidebar.results"}(B||(B={}));r(x(nova.workspace.config.get(B.FormatOnSave)),p((function(n){return y(L.decode(n))})),w((function(){return!1}))),r(x(nova.config.get(B.FormatOnSave)),p((function(n){return y(L.decode(n))})),w((function(){return!1})));var V=new CompositeDisposable,H=v;exports.activate=function(){console.log(nova.localize("Activating")+"..."),function(n){if(nova.inDevMode()){var e=new NotificationRequest("elixir-nova-notification");e.title=nova.extension.name,e.body=n,nova.notifications.add(e)}}(nova.localize("Starting extension")+"..."),V.add(nova.workspace.onDidAddTextEditor((function(n){}))),P([E((function(){return new Promise((function(n,e){var t=new Process("/usr/bin/env",{args:["chmod","a+x","debugger.sh","language_server.sh","launch.sh"],cwd:nova.path.join(nova.extension.path,"elixir-ls")});t.onDidExit((function(t){return 0===t?n():e()})),t.start()}))}),(function(n){return{_tag:"makeExecutableError",reason:nova.localize("Failed to make files executable")+"."}})),E((function(){return new Promise((function(n,e){var t={path:nova.path.join(nova.extension.path,"elixir-ls","language_server.sh"),type:"stdio"},r=new LanguageClient("elixirLS",nova.extension.name,t,{initializationOptions:{elixirLS:{dialyzerEnabled:!0,fetchDeps:!0,mixEnv:"test"}},syntaxes:["elixir"]});V.add(r.onDidStop((function(n){var e=nova.localize("Elixir Language Server stopped unexpectedly");e+=n?":\n\n"+n.toString():".",e+="\n\n"+nova.localize("Please report this, along with any output in the Extension Console."),nova.workspace.showActionPanel(e,{buttons:[nova.localize("Restart"),nova.localize("Ignore")]},(function(n){}))}))),r.start(),H=m(r),n()}))}),(function(n){return{_tag:"startError",reason:nova.localize("Failed to start language server")+"."}}))])().then(g((function(n){return M.match(n).with({_tag:"makeExecutableError"},(function(n){var e=n.reason;return console.error(e)})).with({_tag:"startError"},(function(n){var e=n.reason;return console.error(e)})).exhaustive()}),(function(n){V.add(nova.commands.register(B.FindReferences,$(H))),V.add(nova.commands.register(B.FormatDocument,function(n){return function(e){r(n,b((function(){return console.log(nova.localize("Skipping. No Langunage Client running.")+".")}),(function(n){J(n,e)().then(g((function(n){return M.match(n).with({_tag:"invokeFormatterError"},(function(n){var e=n.reason;return console.error(e)})).exhaustive()}),(function(){return console.log(nova.localize("Formatted")+" "+e.document.path)})))})))}}(H))),console.log(nova.localize("Activated")+" 🎉")})))},exports.deactivate=function(){console.log(nova.localize("Deactivating")+"..."),E((function(){return new Promise((function(n,e){r(H,b(t,(function(n){n.stop(),H=v}))),n()}))}),(function(n){return{_tag:"shutdownError",reason:"Uh oh... Failed to deactivate plugin."}}))().then(g((function(n){return M.match(n).with({_tag:"shutdownError"},(function(n){var e=n.reason;return console.error(e)})).exhaustive()}),(function(n){return console.log(nova.localize("Deactivated. Come back soon")+" :)")}))),V.dispose()};
//# sourceMappingURL=main.cjs.min.js.map
